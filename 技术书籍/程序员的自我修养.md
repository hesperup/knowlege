# 基础知识

CPU,Memory,I/O

北桥芯片   南桥芯片  PCI bus  Memory bus  Local bus  Cache bus  ISA bus

SMP    多核

软硬件层次体系结构

**计算机科学领域的任何问题都可以通过增加一个间接的中间层来解决。**

### 通信协议称为接口            

 应用程序编程接口 

系统调用接口（软件中断的方式提供）

硬件接口---> 硬件规格

### 高效利用CPU ： 

多道程序 --- 分时系统  --- 多任务系统---抢占式

设备驱动  ； 硬件抽象

### 内存不够用：

1 . 地址空间不隔离 2。 内存使用效率低  3. 程序运行地址不确定

解决：虚拟地址       分段        分页

MMU 进行页映射

### 线程

程序执行的最小单元。 组成：线程ID, 当前指令指针(PC),寄存器集合和堆栈

线程间共享程序的内存空间（代码段  数据段  堆和一些进程级资源--打开文件和信号）

![image-20200709082958593](C:\Users\putao\Documents\Blog\技术书籍\image-20200709082958593.png)

线程状态： Running  Ready Wait

频繁等待的线程为IO密集型线程 （容易得到优先级提升）   很少等待的线程为CPU密集型线程

保证线程安全：单指令，竞争与原子操作；同步与锁：二元信号量(Binary Semaphore)，多元信号量(Semaphore)，互斥量（Mutex),临界区(Critical Section),读写锁（RW Lock),条件变量（Condition Variable);可重入与线程安全，过度优化（指令优化）:volatile,Singleton模式的double-check问题，barrier指令

三种线程模型：一对一    多对一  多对多

# 静态链接

## 编译和链接

预处理Prepressing(*.i文件)--编译Compilation(*.s文件)--汇编Assembly(*.o文件)--链接Linking(*.out文件)

编译：扫描（词法分析）--语法分析--语义分析--源代码优化--代码生成--目标代码优化

工具链：lex -- yacc --

链接： 地址和空间分配，符号决议，重定位

目标文件格式：PE(Windows),ELF(Linux) 都来源于COFF

代码段 和 数据段

1. 指令只读  2. 提高缓存命中率 3. 指令可以共享

代码段  objdump -s  -d demo.o

数据段（已经初始化的全局静态变量和局部静态变量）和只读数据段（只读变量和字符串常量）

objdump -x -s -d demo.o

cpu 字节序

BSS段(未初始化的全局变量和局部静态变量)  不占用文件空间

其他段：

.rodata1,.comment,.debug,.dynamic,.hash,.line,.note,.strtab,.symtab,.shatrtab,.plt,.got,.init,.fini

自动段：

ELF文件结构描述

文件头   readelf  -h命令查看

段表:readelf -S

重定位表：

字符串表：

链接的接口--符号

调试信息

## 静态链接

空间与地址分配： 两步链接

符号解析与重定位

COMMON块

C++相关问题

静态库链接

链接过程控制

BFD库



## Windows PE/COFF

![image-20200711183454593](C:\Users\putao\Documents\Blog\技术书籍\image-20200711183454593.png)

![image-20200711183609894](C:\Users\putao\Documents\Blog\技术书籍\image-20200711183609894.png)

# 装载与动态链接

## 可执行文件的装载与进程

overlay 

页映射

动态链接 PIE   延迟绑定  PLT 